### 一、部署前的准备条件

在开始部署前，你需要先满足这些基础条件：

1. **服务器环境**：

- - 拥有一台可访问的服务器（云服务器如阿里云、腾讯云，或本地虚拟机），系统推荐 Linux（CentOS、Ubuntu 等）。
  - 服务器已安装 Nginx（安装命令附在下方）。

1. **前端项目包**：

- - 前端项目已完成打包（React/Vue/Angular 等框架需执行 `npm run build` 生成 `dist` 目录，原生前端直接整理静态文件即可）。
  - 打包后的文件无路径错误（比如静态资源路径要使用相对路径或正确的绝对路径）。

1. **网络权限**：

- - 服务器开放 80（HTTP）、443（HTTPS）端口（如果用自定义端口，需开放对应端口）。
  - 本地能通过 SSH 连接服务器，或能通过 FTP/SCP 上传文件到服务器。

### 二、Nginx 部署前端的核心步骤

#### 1. 安装 Nginx（以 CentOS 为例）

```
# 安装依赖
yum install -y gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel
# 安装 Nginx
yum install -y nginx
# 启动 Nginx
systemctl start nginx
# 设置开机自启
systemctl enable nginx
# 查看 Nginx 状态
systemctl status nginx
```

Ubuntu 系统安装命令：

```
apt update && apt install -y nginx
systemctl start nginx
systemctl enable nginx
```

#### 2. 上传前端打包文件到服务器

将本地打包好的 `dist` 目录（或静态文件目录）上传到服务器，推荐路径：

```
# 新建前端项目目录（自定义，比如项目名是 my-frontend）
mkdir -p /usr/share/nginx/my-frontend
# 通过 scp 上传本地 dist 目录到服务器（本地执行）
scp -r 本地dist路径 root@服务器IP:/usr/share/nginx/my-frontend/
```

#### 3. 配置 Nginx 核心配置文件

Nginx 的配置文件默认路径：`/etc/nginx/nginx.conf`（主配置），推荐在 `/etc/nginx/conf.d/` 下新建项目专属配置文件（避免修改主配置）：

```
# 新建配置文件
vim /etc/nginx/conf.d/my-frontend.conf
```

写入以下核心配置（注释已说明关键项）：

```
# 监听端口（80是HTTP默认端口，自定义需开放防火墙）
server {
  listen       80;
  # 服务器域名/IP（多个域名用空格分隔，比如 www.xxx.com xxx.com）
  server_name  your_server_ip your_domain.com;

  # 字符编码（避免中文乱码）
  charset utf-8;

  # 前端项目根目录（指向你上传的 dist 目录）
  root /usr/share/nginx/my-frontend/dist;
  # 默认首页（按优先级匹配，index.html 是前端打包的默认首页）
  index index.html index.htm;

  # 关键：解决前端路由刷新404问题（Vue/React Router的history模式）
  location / {
    # 如果请求的文件不存在，转发到 index.html（让前端路由处理）
    try_files $uri $uri/ /index.html;
  }

  # 静态资源缓存（优化加载速度，根据需求调整缓存时间）
  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    # 缓存有效期7天（单位：d天/h小时/m分钟/s秒）
    expires 7d;
    # 关闭日志（减少Nginx日志体积）
    access_log off;
  }

  # 反向代理解决跨域（如果前端需要请求后端接口）
  location /api {
    # 后端接口地址（替换为你的真实后端地址）
    proxy_pass http://your_backend_ip:backend_port;
    # 传递真实IP给后端
    proxy_set_header X-Real-IP $remote_addr;
    # 传递域名/端口给后端
    proxy_set_header Host $host;
    # 传递代理信息给后端
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

  # 错误页面配置（可选，提升用户体验）
  error_page 404 /index.html;
  error_page 500 502 503 504 /50x.html;
  location = /50x.html {
    root /usr/share/nginx/html;
  }
}
```

#### 4. 验证配置并重启 Nginx

```
# 检查Nginx配置是否有语法错误（关键！避免配置错导致Nginx启动失败）
nginx -t
# 配置正确的话，重启Nginx生效
systemctl restart nginx
```

#### 5. 访问验证

在浏览器输入 `http://服务器IP` 或 `http://你的域名`，能正常显示前端页面即部署成功。

### 三、部署的关键注意事项

1. **路径相关**：

- - 前端打包时的 `publicPath`（Vue）/ `homepage`（React）要配置正确：如果部署在根路径（如 `http://ip/`），设为 `/`；如果部署在子路径（如 `http://ip/my-app/`），需设为 `/my-app/`，且 Nginx 配置的 `root` 或 `location` 要对应。
  - 避免前端代码中写死绝对路径（比如 `http://localhost:8080/api`），建议用相对路径或环境变量。

1. **Nginx 权限问题**：

- - 前端文件目录的权限要给 Nginx 进程（默认用户 `nginx` 或 `www-data`）可读权限：bash运行

```
chown -R nginx:nginx /usr/share/nginx/my-frontend
chmod -R 755 /usr/share/nginx/my-frontend
```

- - 避免 Nginx 配置文件权限过高（推荐 644），防止安全风险。

1. **跨域与反向代理**：

- - 前端直接请求后端接口会跨域，优先用 Nginx 反向代理（上面配置中的 `/api` 部分），而非前端本地代理（本地代理仅开发环境用）。
  - 反向代理时注意 `proxy_pass` 结尾是否加 `/`：比如 `proxy_pass http://backend/` 会把 `/api/test` 转发为 `http://backend/test`，不加则转发为 `http://backend/api/test`。

1. **HTTPS 配置（必做！生产环境）**：

- - 生产环境必须配置 HTTPS（避免浏览器拦截、数据泄露），需先申请 SSL 证书（阿里云 / 腾讯云免费申请），然后修改 Nginx 配置监听 443 端口：nginx

```
server {
    listen 443 ssl;
    server_name your_domain.com;
    # SSL 证书路径（替换为你的证书文件路径）
    ssl_certificate /etc/nginx/ssl/your_domain.crt;
    ssl_certificate_key /etc/nginx/ssl/your_domain.key;
    # SSL 协议配置（提升安全性）
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    # 其他配置（root、index、location 等和HTTP一致）
}
# 强制HTTP跳转到HTTPS
server {
    listen 80;
    server_name your_domain.com;
    rewrite ^(.*)$ https://$host$1 permanent;
}
```

1. **性能优化**：

- - 开启 Nginx gzip 压缩（减少静态文件体积），在 `nginx.conf` 的 `http` 块中添加：nginx

```
gzip on;
gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
gzip_buffers 16 8k;
gzip_comp_level 6; # 压缩级别（1-9，级别越高压缩率越高，消耗CPU越多）
```

- - 静态资源使用 CDN 加速（把 js、css、图片等放到 CDN，Nginx 只代理页面入口）。

1. **日志与监控**：

- - Nginx 日志默认路径：`/var/log/nginx/access.log`（访问日志）、`/var/log/nginx/error.log`（错误日志），部署后要检查 error.log 排查问题。
  - 避免日志过大：配置日志切割（Linux 用 logrotate），或关闭静态资源的访问日志（上面配置中的 `access_log off`）。